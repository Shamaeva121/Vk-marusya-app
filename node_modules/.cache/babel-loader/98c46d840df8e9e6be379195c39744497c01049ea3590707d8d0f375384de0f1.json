{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useParams,useNavigate,Link}from'react-router-dom';import{getMovies}from'../../api/apiClient';import'./GenreMoviesPage.scss';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function GenreMoviesPage(){const{genreName}=useParams();const navigate=useNavigate();const[movies,setMovies]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[displayedMoviesCount,setDisplayedMoviesCount]=useState(10);const hasMoreMovies=displayedMoviesCount<movies.length;useEffect(()=>{const fetchMoviesByGenre=async()=>{setLoading(true);setError(null);try{if(genreName){const data=await getMovies(1,20000,genreName);if(Array.isArray(data)){setMovies(data);}else{setError(\"Не удалось загрузить фильмы для этого жанра.\");setMovies([]);}}else{setError(\"Название жанра не указано.\");setMovies([]);}}catch(err){var _err$response,_err$response$data;console.error(\"Error fetching movies for genre \".concat(genreName,\":\"),err);setError((err===null||err===void 0?void 0:(_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||err.message||'Не удалось загрузить фильмы.');setMovies([]);}finally{setLoading(false);}};fetchMoviesByGenre();},[genreName]);const handleShowMore=()=>{setDisplayedMoviesCount(prev=>prev+10);};const handleGoBack=()=>{navigate(-1);};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"genre-movies-page__loading\",children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"});}if(error){return/*#__PURE__*/_jsxs(\"div\",{className:\"genre-movies-page__error\",children:[\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430: \",error]});}const displayedMovies=movies.slice(0,displayedMoviesCount);return/*#__PURE__*/_jsx(\"div\",{className:\"genre-movies-page\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"genre-movies-page__header\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"genre-movies-page__back-button\",onClick:handleGoBack,children:/*#__PURE__*/_jsx(\"img\",{src:\"/icons/icon-back.svg\",alt:\"Back\",className:\"genre-movies-page__back-arrow\"})}),/*#__PURE__*/_jsx(\"h1\",{className:\"genre-movies-page__title\",children:genreName})]}),/*#__PURE__*/_jsx(\"div\",{className:\"genre-movies-page__list\",children:displayedMovies.map((movie,index)=>/*#__PURE__*/_jsx(\"div\",{className:\"genre-movies-page__item\",children:/*#__PURE__*/_jsx(Link,{to:\"/movie/\".concat(movie.id),children:/*#__PURE__*/_jsx(\"img\",{src:movie.posterUrl,alt:\"Movie \".concat(index+1),className:\"genre-movies-page__item__image\"})})},index))}),hasMoreMovies&&/*#__PURE__*/_jsx(\"button\",{className:\"genre-movies-page__show-more\",onClick:handleShowMore,children:\"\\u041F\\u043E\\u043A\\u0430\\u0437\\u0430\\u0442\\u044C \\u0435\\u0449\\u0451\"})]})});}export default GenreMoviesPage;","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","Link","getMovies","jsx","_jsx","jsxs","_jsxs","GenreMoviesPage","genreName","navigate","movies","setMovies","loading","setLoading","error","setError","displayedMoviesCount","setDisplayedMoviesCount","hasMoreMovies","length","fetchMoviesByGenre","data","Array","isArray","err","_err$response","_err$response$data","console","concat","response","message","handleShowMore","prev","handleGoBack","className","children","displayedMovies","slice","onClick","src","alt","map","movie","index","to","id","posterUrl"],"sources":["d:/Users/User55/Documents/GitHub/Vk-marusya-app/src/pages/GenreMoviesPage/GenreMoviesPage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate, Link } from 'react-router-dom';\nimport { getMovies } from '../../api/apiClient';\nimport { Movie } from '../../types/types';\nimport './GenreMoviesPage.scss';\n\nfunction GenreMoviesPage() {\n  const { genreName } = useParams<{ genreName: string }>();\n  const navigate = useNavigate();\n\n  const [movies, setMovies] = useState<Movie[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [displayedMoviesCount, setDisplayedMoviesCount] = useState(10);\n  const hasMoreMovies = displayedMoviesCount < movies.length;\n\n  useEffect(() => {\n    const fetchMoviesByGenre = async () => {\n      setLoading(true);\n      setError(null);\n      try {\n        if (genreName) {\n          const data = await getMovies(1, 20000, genreName);\n          if (Array.isArray(data)) {\n            setMovies(data);\n          } else {\n            setError(\"Не удалось загрузить фильмы для этого жанра.\");\n            setMovies([]);\n          }\n        } else {\n          setError(\"Название жанра не указано.\");\n          setMovies([]);\n        }\n      } catch (err: any) {\n        console.error(`Error fetching movies for genre ${genreName}:`, err);\n        setError(err?.response?.data?.message || err.message || 'Не удалось загрузить фильмы.');\n        setMovies([]);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchMoviesByGenre();\n  }, [genreName]);\n\n  const handleShowMore = () => {\n    setDisplayedMoviesCount(prev => prev + 10);\n  };\n\n  const handleGoBack = () => {\n    navigate(-1);\n  };\n\n  if (loading) {\n    return <div className=\"genre-movies-page__loading\">Загрузка...</div>;\n  }\n\n  if (error) {\n    return <div className=\"genre-movies-page__error\">Ошибка: {error}</div>;\n  }\n\n  const displayedMovies = movies.slice(0, displayedMoviesCount);\n\n  return (\n    <div className=\"genre-movies-page\">\n      <div className=\"container\">\n        <div className=\"genre-movies-page__header\">\n          <button className=\"genre-movies-page__back-button\" onClick={handleGoBack}>\n            <img src=\"/icons/icon-back.svg\" alt=\"Back\" className=\"genre-movies-page__back-arrow\" />\n          </button>\n          <h1 className=\"genre-movies-page__title\">{genreName}</h1>\n        </div>\n        <div className=\"genre-movies-page__list\">\n          {displayedMovies.map((movie, index) => (\n            <div key={index} className=\"genre-movies-page__item\">\n              <Link to={`/movie/${movie.id}`}>\n                <img src={movie.posterUrl} alt={`Movie ${index + 1}`} className=\"genre-movies-page__item__image\" />\n              </Link>\n            </div>\n          ))}\n        </div>\n        {hasMoreMovies && (\n          <button className=\"genre-movies-page__show-more\" onClick={handleShowMore}>\n            Показать ещё\n          </button>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default GenreMoviesPage;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}